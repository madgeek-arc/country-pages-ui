<form [formGroup]="form">
<!--  {{fieldData.field.name}}-->
  <div *ngIf="fieldData.field.label.text" class="uk-form-label uk-margin-bottom" [attr.for]="fieldData.field.name">
    {{fieldData.field.label.text + (fieldData.field.form.mandatory ? ' (*)' : '')}}
  </div>
  <div *ngIf="fieldData.field.form.description.text" class="uk-form-description uk-margin-bottom uk-width-9-10"
       [innerHTML]="fieldData.field.form.description.text">
  </div>
  <div *ngIf="fieldData.field.typeInfo.multiplicity; else noMultiplicity">
    <div *ngFor="let control of fieldAsFormArray().controls; let i=index">
      <div [formGroupName]="i" class="uk-margin-bottom formGroupElement uk-width-1-1 uk-display-inline-block">
        <div *ngFor="let control of fieldData?.subFieldGroups; let j=index">
          <div class="">
            <div *ngIf="control.field.typeInfo.type === 'composite'">
              <app-composite-field [fieldData]="control" [subVocabularies]="subVocabularies"
                                   [vocabularies]="vocabularies"
                                   [position]="i" (handleBitSets)="handleBitsetOfChildren($event)"
                                   (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
              </app-composite-field>
            </div>
            <div *ngIf="control.field.typeInfo.type === 'vocabulary'" class="uk-form-controls uk-margin-medium-top">
              <app-vocabulary-field [fieldData]="control" [subVocabularies]="subVocabularies"
                                    [vocabularies]="vocabularies"
                                    [position]="i" (handleBitSets)="handleBitsetOfChildren($event)"
                                    (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
              </app-vocabulary-field>
            </div>
            <div *ngIf="control.field.typeInfo.type === 'string' || control.field.typeInfo.type === 'email'||
                      control.field.typeInfo.type === 'phone' || control.field.typeInfo.type === 'url' ||
                      control.field.typeInfo.type === 'double'">
              <app-string-url-email-field [fieldData]="control" [position]="i"
                                          (handleBitSets)="handleBitsetOfChildren($event)"
                                          (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
              </app-string-url-email-field>
            </div>
            <div *ngIf="control.field.typeInfo.type === 'number'">
              <app-number-field [fieldData]="control" [position]="i"
                                (handleBitSets)="handleBitsetOfChildren($event)"
                                (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
              </app-number-field>
            </div>
            <div *ngIf="control.field.typeInfo.type === 'largeText'">
              <app-large-text [fieldData]="control" [position]="i"
                              (handleBitSets)="handleBitsetOfChildren($event)"
                              (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
              </app-large-text>
            </div>
            <div *ngIf="control.field.typeInfo.type === 'radio'" class="uk-form-controls">
              <app-radio-button-field [fieldData]="control" [position]="i"
                                      (handleBitSets)="handleBitsetOfChildren($event)"
                                      (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
              </app-radio-button-field>
            </div>
            <div *ngIf="control.field.typeInfo.type === 'date'">
              <app-date-field [fieldData]="control" [position]="i"
                              (handleBitSets)="handleBitsetOfChildren($event)"
                              (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
              </app-date-field>
            </div>
          </div>
        </div>
      </div>
      <a *ngIf="fieldAsFormArray().length > 1" class="remove-element uk-padding-small uk-display-inline-block"
         (click)="remove(i); updateBitSetOfComposite(fieldData, i); unsavedChangesPrompt();">
        <span class="material-icons">clear</span>
      </a>
    </div>
    <div class="uk-width-9-10 uk-text-center uk-margin-top">
      <a class="add-new-element uk-flex uk-flex-middle uk-flex-center" (click)="pushComposite(fieldData.subFieldGroups)">
        <span class="material-icons">add</span> Add {{fieldData.field.label.text}}
      </a>
    </div>
  </div>

  <ng-template #noMultiplicity>
    <div class="uk-width-1-1 uk-display-inline-block" [ngClass]="{'uk-margin-bottom formGroupElement': fieldData.field.form.display.hasBorder}">
      <div *ngFor="let control of fieldData?.subFieldGroups; let j=index">
        <div class="">
          <div *ngIf="control.field.typeInfo.type === 'composite'">
            <app-composite-field [fieldData]="control" [subVocabularies]="subVocabularies" [vocabularies]="vocabularies"
                                 (handleBitSets)="handleBitsetOfChildren($event)"
                                 (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
            </app-composite-field>
          </div>

          <div *ngIf="control.field.typeInfo.type === 'vocabulary' || control.field.typeInfo.type === 'select'" class="uk-form-controls uk-margin-medium-top">
            <app-vocabulary-field [fieldData]="control" [subVocabularies]="subVocabularies"
                                  [vocabularies]="vocabularies"
                                  (handleBitSets)="handleBitsetOfChildren($event)"
                                  (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
            </app-vocabulary-field>
          </div>

          <div *ngIf="control.field.typeInfo.type === 'string' || control.field.typeInfo.type === 'url' ||
                    control.field.typeInfo.type === 'email' || control.field.typeInfo.type === 'phone' ||
                    control.field.typeInfo.type === 'double'">
            <app-string-url-email-field [fieldData]="control"
                                        (handleBitSets)="handleBitsetOfChildren($event)"
                                        (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
            </app-string-url-email-field>
          </div>

          <div *ngIf="control.field.typeInfo.type === 'number'">
            <app-number-field [fieldData]="control"
                              (handleBitSets)="handleBitsetOfChildren($event)"
                              (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
            </app-number-field>
          </div>

          <div *ngIf="control.field.typeInfo.type === 'checkbox'" class="uk-form-controls">
            <app-checkbox-field [fieldData]="control"
                                (handleBitSets)="handleBitsetOfChildren($event)"
                                (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
            </app-checkbox-field>
          </div>

          <div *ngIf="control.field.typeInfo.type === 'largeText'" class="uk-form-controls">
            <app-large-text [fieldData]="control"
                            (handleBitSets)="handleBitsetOfChildren($event)"
                            (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
            </app-large-text>
          </div>

          <div *ngIf="control.field.typeInfo.type === 'radio'" class="uk-form-controls">
            <app-radio-button-field [fieldData]="control"
                                    (handleBitSets)="handleBitsetOfChildren($event)"
                                    (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
            </app-radio-button-field>
          </div>
          <div *ngIf="control.field.typeInfo.type === 'date'">
            <app-date-field [fieldData]="control"
                            (handleBitSets)="handleBitsetOfChildren($event)"
                            (handleBitSetsOfComposite)="handleCompositeBitsetOfChildren($event)">
            </app-date-field>
          </div>
          <div *ngIf="control.field.typeInfo.type === 'radioGrid'">
            <app-radio-grid [fieldData]="control">
            </app-radio-grid>
          </div>
        </div>
      </div>
    </div>
  </ng-template>

  <div *ngIf="fieldData.field.form.suggestion.text" class="uk-margin-top">
    <div class="uk-suggestion uk-width-9-10" [innerHTML]="fieldData.field.form.suggestion.text"></div>
  </div>

</form>
<!--<pre>{{fieldData | json}}</pre>-->
